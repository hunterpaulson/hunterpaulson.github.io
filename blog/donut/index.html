<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />
  <meta name="dcterms.date" content="2025-10-15" />
  <title>donut.c | hunter paulson</title>
  <link rel="stylesheet" href="/src/reset.css" />
  <link rel="stylesheet" href="/src/index.css" />
</head>
<body>
<table class="header">
  <tr>
    <td colspan="5" class="width-auto">
      <h1 class="title"><a href="/" class="site-title">hunter paulson</a></h1>
      <div class="post-header">
        <span class="post-title">donut.c</span>
        <span class="post-date">2025-10-15</span>
      </div>
    </td>
  </tr>
  <tr>
    <td class="width-min"><a href="/blog/">blog</a></td>
    <td class="width-min"><a href="/projects/">projects</a></td>
    <td class="width-auto"></td>
    <td class="width-min"><a href="https://github.com/hunterpaulson">github</a></td>
    <td class="width-min"><a href="https://www.linkedin.com/in/hunterpaulson">linkedin</a></td>
  </tr>
</table>
<div class="{=html}">
<pre
  id="donut-screen"
  style="
    width:80ch;
    height:calc(40 * var(--line-height));
    margin:calc(var(--line-height) * 2) auto;
    white-space:pre;
    overflow:hidden;
  "
  aria-live="off"
>
(loading donut...)
</pre>
<script>
(function () {
  const screen = document.getElementById("donut-screen");
  if (!screen) return;

  const width = 80;
  const height = 45;
  const luminanceMap = ".,-~:;=!*#$@";
  const z = new Array(width * height);
  const buffer = new Array(width * height);

  let A = 0;
  let B = 0;

  function clamp(value, min, max) {
    if (value < min) return min;
    if (value > max) return max;
    return value;
  }

  function frame() {
    z.fill(0);
    buffer.fill(" ");

    A += 0.07;
    B += 0.03;

    const cA = Math.cos(A);
    const sA = Math.sin(A);
    const cB = Math.cos(B);
    const sB = Math.sin(B);

    for (let j = 0; j < 6.28; j += 0.07) {
      const cT = Math.cos(j);
      const sT = Math.sin(j);
      for (let i = 0; i < 6.28; i += 0.02) {
        const sP = Math.sin(i);
        const cP = Math.cos(i);
        const h = cT + 2;
        const invZ = 1 / (sP * h * sA + sT * cA + 5);
        const t = sP * h * cA - sT * sA;

        const x = Math.floor(width / 2 + (width * 0.375) * invZ * (cP * h * cB - t * sB));
        const y = Math.floor(height / 2 + (height * 0.35) * invZ * (cP * h * sB + t * cB));
        if (y < 0 || y >= height || x < 0 || x >= width) continue;

        const idx = x + width * y;

        const luminance = clamp(
          Math.floor(
            8 * (
              (sT * sA - sP * cT * cA) * cB -
              sP * cT * sA -
              sT * cA -
              cP * cT * sB
            )
          ),
          0,
          luminanceMap.length - 1
        );

        if (invZ > z[idx]) {
          z[idx] = invZ;
          buffer[idx] = luminanceMap[luminance];
        }
      }
    }

    let output = "";
    for (let k = 0; k < buffer.length; k++) {
      output += buffer[k];
      if ((k + 1) % width === 0 && k !== buffer.length - 1) output += "\n";
    }
    screen.textContent = output;
  }

  frame();
  setInterval(frame, 50);
})();
</script>
</div>
<p><a href="https://www.a1k0n.net/2011/07/20/donut-math.html">aikon’s
donut.c</a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>             k<span class="op">;</span><span class="dt">double</span> sin<span class="op">()</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>         <span class="op">,</span>cos<span class="op">();</span>main<span class="op">(){</span><span class="dt">float</span> A<span class="op">=</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>       <span class="dv">0</span><span class="op">,</span>B<span class="op">=</span><span class="dv">0</span><span class="op">,</span>i<span class="op">,</span>j<span class="op">,</span>z<span class="op">[</span><span class="dv">1760</span><span class="op">];</span><span class="dt">char</span> b<span class="op">[</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>     <span class="dv">1760</span><span class="op">];</span>printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">\x1b</span><span class="st">[2J&quot;</span><span class="op">);</span><span class="cf">for</span><span class="op">(;;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">){</span>memset<span class="op">(</span>b<span class="op">,</span><span class="dv">32</span><span class="op">,</span><span class="dv">1760</span><span class="op">);</span>memset<span class="op">(</span>z<span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">7040</span><span class="op">)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">;</span><span class="cf">for</span><span class="op">(</span>j<span class="op">=</span><span class="dv">0</span><span class="op">;</span><span class="fl">6.28</span><span class="op">&gt;</span>j<span class="op">;</span>j<span class="op">+=</span><span class="dv">0</span><span class="er">.07</span><span class="op">)</span><span class="cf">for</span><span class="op">(</span>i<span class="op">=</span><span class="dv">0</span><span class="op">;</span><span class="fl">6.28</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a> <span class="op">&gt;</span>i<span class="op">;</span>i<span class="op">+=</span><span class="dv">0</span><span class="er">.02</span><span class="op">){</span><span class="dt">float</span> c<span class="op">=</span>sin<span class="op">(</span>i<span class="op">),</span>d<span class="op">=</span>cos<span class="op">(</span>j<span class="op">),</span>e<span class="op">=</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a> sin<span class="op">(</span>A<span class="op">),</span>f<span class="op">=</span>sin<span class="op">(</span>j<span class="op">),</span>g<span class="op">=</span>cos<span class="op">(</span>A<span class="op">),</span>h<span class="op">=</span>d<span class="op">+</span><span class="dv">2</span><span class="op">,</span>D<span class="op">=</span><span class="dv">1</span><span class="op">/(</span>c<span class="op">*</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a> h<span class="op">*</span>e<span class="op">+</span>f<span class="op">*</span>g<span class="op">+</span><span class="dv">5</span><span class="op">),</span>l<span class="op">=</span>cos      <span class="op">(</span>i<span class="op">),</span>m<span class="op">=</span>cos<span class="op">(</span>B<span class="op">),</span>n<span class="op">=</span>s\</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>in<span class="op">(</span>B<span class="op">),</span>t<span class="op">=</span>c<span class="op">*</span>h<span class="op">*</span>g<span class="op">-</span>f<span class="op">*</span>        e<span class="op">;</span><span class="dt">int</span> x<span class="op">=</span><span class="dv">40</span><span class="op">+</span><span class="dv">30</span><span class="op">*</span>D<span class="op">*</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>l<span class="op">*</span>h<span class="op">*</span>m<span class="op">-</span>t<span class="op">*</span>n<span class="op">),</span>y<span class="op">=</span>            <span class="dv">12</span><span class="op">+</span><span class="dv">15</span><span class="op">*</span>D<span class="op">*(</span>l<span class="op">*</span>h<span class="op">*</span>n</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>t<span class="op">*</span>m<span class="op">),</span>o<span class="op">=</span>x<span class="op">+</span><span class="dv">80</span><span class="op">*</span>y<span class="op">,</span>          N<span class="op">=</span><span class="dv">8</span><span class="op">*((</span>f<span class="op">*</span>e<span class="op">-</span>c<span class="op">*</span>d<span class="op">*</span>g</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a> <span class="op">)*</span>m<span class="op">-</span>c<span class="op">*</span>d<span class="op">*</span>e<span class="op">-</span>f<span class="op">*</span>g<span class="op">-</span>l        <span class="op">*</span>d<span class="op">*</span>n<span class="op">);</span><span class="cf">if</span><span class="op">(</span><span class="dv">22</span><span class="op">&gt;</span>y<span class="op">&amp;&amp;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a> y<span class="op">&gt;</span><span class="dv">0</span><span class="op">&amp;&amp;</span>x<span class="op">&gt;</span><span class="dv">0</span><span class="op">&amp;&amp;</span><span class="dv">80</span><span class="op">&gt;</span>x<span class="op">&amp;&amp;</span>D<span class="op">&gt;</span>z<span class="op">[</span>o<span class="op">]){</span>z<span class="op">[</span>o<span class="op">]=</span>D<span class="op">;;;</span>b<span class="op">[</span>o<span class="op">]=</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a> <span class="st">&quot;.,-~:;=!*#$@&quot;</span><span class="op">[</span>N<span class="op">&gt;</span><span class="dv">0</span><span class="op">?</span>N<span class="op">:</span><span class="dv">0</span><span class="op">];}}</span><span class="co">/*#****!!-*/</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">\x1b</span><span class="st">[H&quot;</span><span class="op">);</span><span class="cf">for</span><span class="op">(</span>k<span class="op">=</span><span class="dv">0</span><span class="op">;</span><span class="dv">1761</span><span class="op">&gt;</span>k<span class="op">;</span>k<span class="op">++)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>   putchar<span class="op">(</span>k<span class="op">%</span><span class="dv">80</span><span class="op">?</span>b<span class="op">[</span>k<span class="op">]:</span><span class="dv">10</span><span class="op">);</span>A<span class="op">+=</span><span class="dv">0</span><span class="er">.04</span><span class="op">;</span>B<span class="op">+=</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>     <span class="dv">0</span><span class="er">.02</span><span class="op">;}}</span><span class="co">/*****####*******!!=;:~</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">       ~::==!!!**********!!!==::-</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">         .,~~;;;========;;;:~-.</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">             ..,--------,*/</span></span></code></pre></div>
<p>try ‘debug mode’ below</p>
<hr />
<footer class="site-footer">
  <div class="footer-controls">
    <label class="debug-toggle-label"><input type="checkbox" class="debug-toggle" /> debug mode</label>
    <label class="theme-toggle-label"><input type="checkbox" class="theme-toggle" checked /> dark mode</label>
  </div>
  <span class="footer-attribution">built with <a href="https://owickstrom.github.io/the-monospace-web/">the monospace web</a></span>
</footer>
  <div class="debug-grid"></div>
  <script src="/src/index.js"></script>
</body>
</html>
